## Factory Method Pattern

<small>| **한 줄 소개** | 팩토리 확장 - 팩토리 패턴에 추상화를 결합 </small>

<br/>

## 3.1 추상화

<br/>

### 3.1.1 추상 개념

추상은 사전적 의미로 중요한 부분만 분리하여 이해하기 쉽게 만드는 작업

모듈의 복잡한 기능에 대해 이해할 때 파앗하려는 기능이 요약된 정보가 있다면 보다 쉽게 이해할 수 있을 것

추상 개념을 적용하는 이유는 객체의 동작을 보다 쉽게 파악하기 위함

코드 작성 시 복잡한 기능을 어떻게 요약해서 정보를 만들어야 할까?

먼저 기능을 이해하기 위해 세부 사항을 분리

<br/>

### 3.1.2 코드 요약

추상화 작업은 코드를 요약하는 것

추상화 작업을 위해서는 먼저 요약된 정보와 실제 구현부를 분리함

<br/>

## 3.2 패턴 확장

추상화를 통해 팩토리 패턴을 확장함

중요한 부분만 분리하여 추상 클래스의 골격을 형성함

<br/>

### 3.2.1 팩토리

팩토리 패턴은 객체지향을 지원하는 현대적modern 프로그래밍에서 가장 폭넓게 사용되는 패턴 중 하나

```java
class LgProduct {
	public void name() {
		System.out.println("LG Gram laptop");
	}
}
```

```java
class Factory {
	public LgProduct create() {
		return new LgProduct();
	}
}
```

```java
class Main {
	public static void main() {
		Factory fac = new Factory();
		LgProduct pro = fac.create();
		pro.name();
	}
}
```

<br/>

### 3.2.2 추상화

앞에서 작성한 팩토리 패턴에 추상화를 결합하고 패턴을 확장해 구현함 

추상화를 적용하면 팩토리 패턴은 팩토리 메서드 패턴과 추상 팩토리 패턴 2가지 형태로 구분

기존의 Factory 클래스를 추상 클래스로 변경하는데, 추상 클래스를 적용하는 것은 객체를 생산하고 사용하는 것을 분리하기 위해서임

```java
abstract class Factory {
	public LgProduct create() {
	/*
		return new LgProduct();
		-> 하위 클래스로 위임
	*/
		return this.createProduct();
	}

	abstract public LgProduct createProduct();
}
```

변경된 Factory 클래스 안에는 추상 메서드도 선언되어있음

객체를 생성하기 위해서는 추상 클래스를 상속받은 하위 클래스를 만들어 실제적인 추상 메서드의 구현부를 작성해야 함

추상화는 선언과 구현이 자연스럽게 분리

추상화로 분리된 클래스 사이에는 의존성이 발생

<br/>

### 3.2.3 인터페이스

<br/>

### 3.2.4 템플릿 메서드 패턴

팩토리 메서드 패턴은 이후에 학습할 템플릿 메서드 패턴과 유사한 모습을 가지고 있음

팩토리 메서드도 실제 생성되는 알고리즘을 하위 메서드로 위임하는데, 실제 구현을 위임한다는 측면에서 책토리 메서드 패턴과 유사하다고 볼 수 있음

<br/>

### 3.2.5 패턴 차이

팩토리 메서드 패턴과 템플릿 메서드 패턴에는 유사한 동작이 있음

공통점 : 추상화를 사용해 객체를 생성하며, 상위 클래스에서 정의를 결정하고 하위 클래스에 구체적인 처리를 위임

차이점 : 해결하려는 목적에 따라 두 패턴에 차이가 있음

<br/>

## 3.3 상위 클래스

<br/>

### 3.3.1 분리

추상화는 클래스의 골격 구조를 변경함

일반 클래스가 추상화로 변경되면, 클래스는 추상 클래스(abstract)와 구현 클래스로 분리됨

<br/>

### 3.2.2 공통된 기능

추상화를 진행하면 클래스는 상위 클래스와 하위 클래스로 분리되고 분리된 클래스는 상속을 통해 결합됨

<br/>

### 3.3.3 개념적 정의

<br/>

### 3.3.4 템플릿

팩토리 메서드와 템츨릿 메서드의 공통점은 템플릿 구성. 템플릿은 모두 추상화를 통해 구성함. 

<br/>

### 3.3.5 계층 구조

<br/>

## 3.4 하위 클래스

<br/>

### 3.4.1 상속

```java
class ProductFactory extends Factory {
	public ProductFactory() {
		System.out.println("ProductFactory 생성");
	}

	public LgProduct createProduct() {
		return new LgProduct();
	}
}
```

<br/>

### 3.4.3 객체를 생성하는 객체

생성 패턴의 특징은 생성을 담당하는 객체가 요청된 객체를 생성한다는 것.

팩토리 메서드는 일반 팩토리 패턴보다 동작이 다소 복잡해보임. 

<br/>

### 3.4.4 다형성

<br/>

### 3.4.5 개방-폐쇄 원칙

개방-폐쇄 원칙Open-Closed Principle은 객체지향의 설계 원칙 중 하나로, 바뀌지 않는 공통된 부분을 분리하여 관리

객체 지향 방법론에서 OCP원칙을 적용하는 대표적인 방법은 다형성

<br/>

### 3.4.6 의존성

생성 패턴은 객체의 생성 과정을 외부에 공개하지 않기 위해 사용함

또한 생성 패턴을 사용하면 직접적으로 new 키워드를 사용하는 빈도가 줄어듦

<br/>

### 3.4.7 캡슐화와 관리

팩토리 메서드 패턴은 클래스 결합도가 낮고 유연성이 좋음. 또한 기능 개선 시 기능을 보완하기 위한 리팩터링 작업도 편리함

<br/>

## 3.5 매개변수

객체 생성 과정을 분리함으로써 다양한 객체 생성을 처리할 수 있는데, 이때 객체 생성을 매개변수화라여 선택적으로 생성할 수도 있음. 분리된 객체는 어떤 객체를 최종 생성, 반환해야 하는지 결정함

<br/>

### 3.5.1 재위임

팩토리 패턴은 객체 생성을 분리된 클래스로 위임하는 반면, 팩토리 메서드는 추상화를 통해 정의와 구현을 재분리함. 실제적인 객체 생성은 재분리된 하위 클래스에서 이루어짐

예를 들어 팩토리 패턴은 부장이 사원을 지정하여 직접 일을 시키는 것이고, 팩토리 메서드 패턴은 중간에 위치한 과장에게 일을 위임하는 것임. 팩토리 메서드 패턴은 팩토리 패턴보다 하위 클래스 파일이 하나 더 생기므로 파일 수가 늘어나지만 하위 클래스를 추가함으로써 객체 지향의 다양성을 적용할 수 있음

<br/>

### 3.5.2 다형성을 이용한 클래스 선택

팩토리 메서드 패턴은 객체의 생성을 군집화하고 군집된 객체를 매개변수로 선택함

```java
class SamsungProduct {
	public void name() {
		System.out.println("Samsung Always laptop");
	}
}
```

Factory 수정

```java
abstract class Factory {
	public Product create(String model) {
		return this.createProduct(model);
	}

	abstract public Product createProduct(String model);
}
```

<br/>

### 3.5.3 매개변수 팩토리 (parameterized factory method)

대형 프로그램을 개발하다 보면 생각보다 많은 수의 객체를 생성해야 함

또, 객체 관계 설정이 복잡해지고 객체 생성을 처리하는 코드 위치도 분산됨

객체 생성을 한 곳에 집중해서 처리하면 유지 보수와 수정이 수월함

팩토리 메서드에서 입력받은 매개변수를 처리할 때 매개변수에 맞는 클래스를 선택하여 객체를 생성함

```java
class ProductFactory extends Factory {
	public ProductFactory() {
		System.out.println("ProductFactory 생성");
	}

	public LgProduct createProduct(String model) {
		if (model == "LG") {
			return new LgProduct();
		} else if (model == "SAMSUNG") {
			return new SamsungProduct();
		}
	}
}
```

<br/>

### 3.5.4 오류 처리

<br/>

## 3.6 관련 패턴

<br/>

### 3.6.1 템플릿 메서드 패턴

팩토리 메서드에서 골격과 생성을 분리할 때 템플릿 메서드 패턴을 응용하는 듯, 템플릿 메서드 패턴과 팩토리 메서드 패턴은 매우 밀접한 관계에 있음

<br/>

### 3.6.2 싱글턴 패턴

팩토리 메서드 패턴은 보통 하나의 객체로 사용하는데, 이를 위해 싱글턴 패턴 방식이나 정적 클래스로 구현함

구현부에서 실체 객체를 생성할 때 싱글턴 페턴을 응용해 중복 생성을 방지

<br/>

### 3.6.3 복합체 패턴

복합체 패턴의 컴포넌트는 추상화되어 있음

컴포넌트의 leaf와 composite는 다형성을 적용하여 구체적 행위가 하위 클래스로 위임됨

또한 컴포넌트 템플릿화되어 구현되지 않은 메서드를 호출해 사용할 수 있음

추상화와 템플릿 처리 과정은 팩토리 템플릿과 유사한 구조로 되어 있음

<br/>

### 3.6.4 반복자 패턴

반복자 패턴은 메서드를 반복적으로 호출

반복해서 생성되는 객체가 있을 경우 팩토리 메서드 패턴을 함께 적용함

<br/>

## 3.7 정리

팩토리 메서드 패턴은 구조화를 통해 선언부와 실현 구현부를 서로 분리함

팩토리 메서드는 프레임워크와 같은 응용 프로그램에서 많이 이용하는 패턴 중 하나

팩토리 메서드 패턴을 이용하면 응용 프로그램에 클래스가 종속되지 않고록 관리할 수 있는데, 그 이유는 객체의 생성 과정을 캡슐화하고 이를 분리하여 관리할 수 있기 때문임. 이는 알고리즘을 처리할 때 프로세스 별로 구별하여 구현하는 것과 비슷