# AWS RDS

- **RDS: 관리형 서비스**

    - 데이터베이스 프로비저닝, OS 패치가 완전 자동화

    - 지속적으로 특정 타임스탬프의 백업 생성으로, 특정 시점 복원 가능

    - 대시보드 모니터링

    - 읽기 전용 복제본 -> 읽기 성능 개선

    - 다중 AZ: 재해 복구

    - 업그레이드로 유지 관리 (Maintenance window)

    - 인스턴스 유형 확장성: 수직/수평 확장

    - EBS (gp2/io1) 에 백업

- **SSH 지원 X**

## RDS Storage Auto Scaling ⭐️

- RDS 스토리지 오토 스케일링 기능이 활성화되어 있을 때, 초기 스토리지 용량보다 데이터베이스를 많이 사용하면 RDS가 이를 감지해서 자동으로 스토리지를 확장

  - DB를 다운시키는 등의 작업을 할 필요가 없음

  - ex. 애플리케이션이 RDS 데이터베이스에서 읽기와 쓰기 작업을 많이 하면 임곗값에 도달하게 되고 RDS가 자동으로 스토리지를 오토 스케일링

- 최대 스토리지 임곗값(Maximum Storage Threshold) 지정: 스토리지를 확장할 최대치를 지정

- 다음과 같은 상황에서 자동으로 스토리지가 자동 확장 (오토 스케일링이 활성화되어 있을 경우)

  - 남은 공간이 10% 미만이 될 때

  - 스토리지 부족 상태가 5분 이상 지속 될 때

  - 지난 수정으로부터 6시간이 지났을 때

=> 워크로드를 예측할 수 없는 애플리케이션에서 굉장히 유용

- 모든 RDS 데이터베이스 엔진에서 지원: MariaDB, MySQL PostgreSQL, SQL Server, Oracle


<small>⭐️⭐️ RDS 읽기 전용 복제본(Read Replicas)과 다중 AZ(Multi-AZ)의 차이, 각 사례를 아는 것이 중요 ⭐️⭐️</small>

애플리케이션 - 데이터베이스 인스턴스에 대해 읽기와 쓰기를 수행

- 특정 데이터베이스 인스턴스가 너무 많은 요청을 받아서 충분히 스케일링할 수가 없음 

  -> 읽기 스케일링

- 읽기 전용 복제본을 최대 다섯 개까지 생성 가능

- ⭐️⭐️ 세 가지 다른 옵션: 동일한 가용 영역(Within AZ) / 가용 영역(Cross AZ) / 리전을 걸쳐서(Cross Region) 

<br/>

<img src="./img/../../img/rds1.png" />

- 메인 RDS 데이터베이스 인스턴스와 두 개의 읽기 전용 복제본 사이에 비동기식 복제가 발생
- 비동기식: 결론적으로 읽기가 일관적으로 유지된다는 것을 의미 (Asynchronous: the reads are eventually consistent)
  - 애플리케이션에서 데이터를 복제하기 전, 읽기 전용 복제본을 읽어들이면 모든 데이터를 얻을 수 있다는 의미

### Read Replica(읽기 복제본)의 승격

- Good for read for scaling reads. 읽기 스케일링에 적합한 조회에 탁월

- 데이터베이스로 승격하여 사용할 수도 있음

- 복제본 중 하나를 데이터베이스로 사용하고자 설정하면, 그에 대한 권한을 획득하면 해당 복제본을 데이터베이스로 승격시킬 수 있음 => 그 후, 이 복제본은 복제 메커니즘을 완전히 탈피하여 자체적인 생애 주기를 갖음

