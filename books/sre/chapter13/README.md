# CHAPTER 13. Emergency Response

<i>긴급 대응</i>

<br>

> 살다 보면 무엇이든 깨지기 마련

조직의 장기적인 번영을 위해서는 긴급 상황에 대한 대응이 필수적임.

적절한 대응을 위해 철저한 준비와 긴급 상황과 관련된 정기적인 실습이 필요.

## What to Do When Systems Break

<small><i>시스템 장애 시 대응 방안</i></small>

당황하지 말고, 다른 사람들에게 도움을 요청.

## Test-Induced Emergency

<small><i>사전적 테스트 접근법</i></small>

테스트 접근 방식은 사전적으로 계획되어야 함.

SRE는 시스템에 의도적으로 장애를 유발하여 시스템이 어떻게 실패하는지 관찰하고, 
반복되지 않도록 신뢰성을 향상할 수 있는 변경 사항을 적용.

### Details

- 분산 MySQL 데이터베이스 중 하나의 테스트 데이터베이스를 사용해 숨겨진 의존성 확인.
- **테스트 계획** → 수백 대의 데이터베이스 중 하나의 데이터베이스에 대한 접근을 차단.

### Response

- 테스트 시작 후 몇 분 내에 데이터베이스에 의존하는 여러 시스템의 내부 및 외부 사용자로부터 접근 불가 오류가 보고되기 시작.
- 권한 변경을 되돌리려 했으나 작업에 실패했으나, 복제(replica) 및 장애 대비(tailborers) 데이터베이스의 권한을 복구하여 해결.
- 약 한 시간 내 모든 권한이 복구됨.
- 테스트의 영향 범위가 예상보다 넓어, 라이브러리에 대한 신속한 수정이 이루어짐. 이와 유사한 현상이 재발하지 않도록 정기적인 테스트 계획 수립.

### Findings

#### What went well

- 예상대로 테스트의 영향이 컸으나 즉시 종료하여 피해를 최소화함.
- 첫 장애 보고 이후 한 시간 안에 모든 권한을 완벽히 복구함.
- 후속 조치 항목도 신속히 처리되어 동일한 장애에 대비할 수 있게 되었으며, 재발 방지를 위해 정기적인 테스트 계획 수립.

#### What we learned

- 철저한 리뷰를 통해 테스트 범위를 잘 규정했다고 생각했으나, 실제로는 의존 관계 시스템 간 특정 상호작용을 완전히 이해하지 못하고 있었음.
- SRE는 지속적으로 장애 대응 도구와 절차를 테스트 및 재정의하며, 장애 관리 절차가 관련 부서에 명확하게 전달되도록 개선할 필요가 있음.
- 테스트 환경에서 롤백 절차를 테스트하지 않았기 때문에 결함이 발생하여 장애 시간이 더 길어짐. 앞으로는 대규모 테스트 시행 전에 롤백 절차를 완벽히 테스트해야 함.


<br><br>
