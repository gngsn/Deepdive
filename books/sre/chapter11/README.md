# CHAPTER 11. Being On-Call

<i>비상 대기</i>

<br>

SRE들은 서비스의 **비상 대기업무 수행**.

SRE 팀은 순수한 운영팀과 달리, 문제 해결을 위한 엔지니어링 접근법을 강조.

SRE가 순수한 운영 업무에 할애할 수 있는 시간을 최대 50%로 제한하고,
나머지 50%의 시간은 서비스 개선 및 자동화를 통한 팀 업무 수행을 개선하는 엔지니어링 프로젝트에 할애하도록 하고 있음.

## Life of an On-Call Engineer

비상 대기 중인 엔지니어는 프로덕션 환경에서 필요한 운영 작업을 **사전 약속된 장애 시 대응 시간** 내에 수행해야 함.

**사전 약속된 장애 시 대응 시간**

- 사용자에게 노출되거나, 시간이 중요한 서비스의 경우: 약 5분
- 시간에 덜 민감한 서비스의 경우: 약 30분

사용자에게 노출되는 서비스의 경우 분기별로 99.99%의 가용성을 확보해야 하며, 이는 분기별로 약 13분의 다운타임만 허용됨.

서비스 중요도가 비교적 낮은 시스템의 경우, 대응 시간을 10분 단위로 정의할 수 있음.

보조 대기조를 교대로 운영하는 것은 필수적이지 않지만, 두 팀이 서로 보조 대기조 역할을 수행하는 것이 일반적.

## Balanced On-Call

SRE 팀은 **비상 대기 업무의 '양'과 '품질'에 대한 상세한 제약**을 둠.

- **비상 대기 업무의 양**: 엔지니어가 비상 대기 업무에 할애한 시간의 백분율로 계산. 
- **비상 대기 업무의 품질**: 비상 대기 기간 동안 발생한 장애 수로 계산.

### 업무 양의 균형

SRE 업무

- 최소 50%의 시간 - 엔지니어링에 투자하려고 노력.
- 남은 50% 중 약 25% - 비상 대기
- 나머지 25% - 프로젝트 업무가 아닌 운영 업무에 할애.

이러한 비율로 인해 최소한의 인력으로 **24/7 비상 대기 조** 운영 가능.

서비스 관련 업무가 많아지면 **다중 사이트 팀 구성을 선호**함.

- 야간 교대는 건강에 좋지 않은 영향을 미치므로, '해 뜰 때' 교대하는 방식으로 야간 교대를 최소화.
- 비상 대기 참여 엔지니어 수를 제한하여 프로덕션 시스템에 대한 지속적인 관심 유지.

-> 이해 안감 ....

### 품질의 균형

비상 대기업무는 매 12시간마다 교대하므로 하루 최대 2개의 장애 처리가 가능.

### 보상

대체 휴무 또는 전체 연봉의 일정 비율로 현금 보상 제공.

보상 정책으로 인해 초과 비상 대기 업무로 인한 잠재적 부작용 완화 가능.

## Feeling Safe

연구 결과에 따르면 사람은 도전에 대해 두 가지 방식으로 대응함.

- 직관적, 자동화적, 신속한 대응
- **합리적, 집중적, 계획적이고 경험에 기반한 행위** ← 복잡한 시스템의 장애를 처리할 때 더 효과적 + 장애 조치 가능

스트레스 호르몬은 인지적 행위에 부정적 영향을 미쳐, 부적절한 의사 결정을 초래할 수 있음.

이상적인 장애 관리 방식은 **충분한 데이터를 활용하여 합리적인 의사 결정을 내리는 것**.

**합리적인 의사 결정을 위한 자원**

- 분명한 장애 전파 경로
- 잘 정의된 장애 관리 프로세스
- 비난 없는 포스트모텀 문화

SRE 지원 시스템을 개발하는 팀은 대부분 24/7 비상 대기업무를 교대로 투입되며, 필요 시 장애를 타 팀에 전파 가능.

SRE 팀은 주요 장애 후 **포스트모텀 문서에 사건 발생 후의 모든 행위를 상세히 기록**함.

소프트웨어는 실수를 줄이기 위해 자동화할 수 있는 부분을 선별해야 함.

## 부적절한 운영 부하에서 벗어나기

### 운영 부하

- **알림**
  - 모니터링 설정 오류는 운영 부담 증가를 초래.
  - 서비스의 SLO를 위협하는 증상이 발생할 때에만 알림 발송이 이루어져야 함.
  - 중복 또는 부정확한 알림은 비활성화가 필요.
  - 장애 알림의 수가 너무 많을 경우 알림/장애 비율이 1:1이 되도록 조정하여 비상 대기 엔지니어가 장애 자체에 집중하도록 함.
- **타 팀 협조**
  - SRE는 개발 팀에게 시스템이 SRE 팀 기준에 도달할 때까지 비상 대기에 집중하도록 요청할 수 있음.
  - 운영 부담이 과도할 경우 개발 팀과 비상 대기 책임을 재조정하고, 일부 또는 전체 호출 알림을 **개발 팀의 비상 대기 엔지니어에게 이양**하기도 함.
    
### 뜻밖의 적: 운영 업무의 부족

SRE 팀은 모든 엔지니어가 최소 분기별로 비상 대기 업무에 투입될 수 있도록 조정함.

문제 해결 능력과 지식 습득 기회를 제공하며, 연간 장애 복구 대회(DiRT)를 열어 시스템을 테스트.


## 결론

구글의 비상 대기 방식은 프로덕션 환경 확장을 책임지며, 
높은 신뢰성과 가용성을 보장하는 SRE의 기본 소양 수행을 지원함.


