# APPENDIX A. 계약에 의한 설계

<br/>

**기존의 문제점**

- 명령과 쿼리를 분리 (Chapter 6) 해도 명령으로 인해 발생하는 부수효과를 명확하게 표현하는 데 한계 존재
  - 구현이 복잡하고 부수효과를 가진 메서드들을 연이어 호출하는 코드를 분석하는 경우, 실행 결과를 예측 어려움
- 명령의 부수효과를 쉽고 명확하게 표현할 수 있는 커뮤니케이션 수단 필요

**👉🏻 설계(Design By Contract, DBC)**
- 실행 가능한 검증 도구로 사용하고 명확한 커뮤니케이션 가능
  - 협력에 필요한 **다양한 제약**과 **부수효과**를 **명시적으로 정의하고 문서화**할 수 있음
  - 계약: 실행 가능 → 구현에 동기화돼 있는지 여부를 런타임에 검증할 수 있음

<br/>

## 01. 협력과 계약

### 부수효과를 명시적으로


**구현 조건:**
1. `IsSatisfied` 메서드를 호출
   - `RecurringSchedule` 의 조건을 만족 여부 확인
2. `Reschedule` 메서드를 호출

- **Interface**
  - 메서드의 순서와 관련된 제약을 설명하기 쉽지 않음 
- **Code Contracts**
  - 계약에 의한 설계 라이브러리
  - IsSatisfied 메서드의 실행 결과가 true 일 때만 Reschedule 메서드를 호출할 수 있다는 사실을 명확하게 표현할 수 있음

```java
class Event {
  public bool IsSatisfied(RecurringSchedule schedule) { ...}

  public void Reschedule(RecurringSchedule schedule) {
    Contract.Requires(IsSatisfied(schedule));
    //...
  }
}
```

<br/>

#### 일반 if 문과 대표적인 차이점 👉🏻 문서화
- Code Contracts: 일반 로직과 구분할 수 있도록 제약 조건을 명시적으로 표현
  - 일반적인 정합성 체크 로직은 코드의 구현 내부에 숨겨져 있어 정확하게 파악하기가 쉽지 않음
  - 일반 로직과 조건을 기술한 로직을 구분하기도 쉽지 않음

<br/>

#### 계약

> - 각 계약 당사자는 계약으로부터 <b>이익(benefit)</b>을 기대하고 이익을 얻기 위해 <b>의무(obligation)</b>를 이행한다. 
> - 각 계약 당사자의 이익과 의무는 계약서에 **문서화**된다.

👉🏻 **한쪽의 의무가 반대쪽의 권리가 된다**

두 계약 당사자 중 어느 한쪽이라도 계약서에 명시된 내용을 위반한다면 계약은 정상적으로 완료되지 않음 

<br/>

**Example.** 집 리모델링을 위해 인테리어 전문가에게 작업을 위탁하고 계약을 체결한다고 가정.
- **본인의 의무**: 인테리어 전문가에게 대금을 지급하는 것 👉🏻 리모델링된 집을 얻는 것
- **인테리어 전문가의 의무**: 집을 리모델링하는 것 👉🏻 대금을 지급받는 것

→ 인테리어 전문가가 계약을 이행하는 구체적인 방식에 대해서는 간섭하지 않는다

<br/>
