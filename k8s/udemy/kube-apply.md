# Kubectl Apply

Declarative - `kubectl apply` 명령 원리

`apply` 명령어는 로컬 구성 파일 & 쿠버네티스의 라이브 개체 정의 & 마지막으로 적용된 구성 고려

`apply` 명령어 실행 시, 객체가 존재하지 않으면 객체를 생성하는데,
이 때, 객체 구성은 로컬로 생성된 것과 유사하지만 개체의 상태를 저장하는 추가 필드 존재

먼저, 로컬에서 작성된 객체 구성 파일의 YAML은 json 형식으로 변환된 후, 적용된 마지막 버전으로 저장

이후, 객체 업데이트 시, 이 세 가지를 모두 비교하여 라이브 오브젝트에 어떤 변화가 있는지 확인

예를 들어 nginX 이미지가 1.19 로 업데이트 하고자 로컬 파일을 수정하면,
가장 먼저 로컬 파일과 쿠버네티스의 라이브 구성 파일과 비교함

만약, 둘 사이 차이가 있다면 라이브 구성 파일은 새 값으로 업데이트 됨

어떠한 변화가 발생하면, 마지막으로 적용된 json 형식은 항상 최신으로 업데이트됨

라이브 개체 구성은 쿠버네티스 메모리에 저장되어 있고,
json은 해당 라이브 객체 구성 파일의